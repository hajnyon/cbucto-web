{% from "partials/icons.njk" import phone, hamburger, close %}

{% set logoHref = "#" if isHome else basePath + "/index.html" %}
{% set navPrefix = "" if isHome else basePath + "/index.html" %}

<a href="#main-content" class="sr-only focus:not-sr-only focus:fixed focus:top-2 focus:left-2 focus:z-[60] focus:px-4 focus:py-2 focus:bg-lime-500 focus:text-white focus:rounded-lg focus:font-bold">
    Přeskočit na obsah
</a>

<nav id="navbar" class="fixed w-full z-50 transition-all duration-300 {{ 'bg-transparent py-4' if isHome else 'bg-white/90 backdrop-blur-md shadow-md py-2' }}" aria-label="Hlavní navigace">
    <div class="container mx-auto px-4 md:px-6 flex justify-between items-center">

        <!-- LOGO -->
        <a href="{{ logoHref }}" class="flex items-center gap-2 transform hover:scale-105 transition-transform duration-300 origin-left">
            <img src="{{ basePath }}/logo.png" alt="{{ site.name }}" class="{{ 'h-16 md:h-20' if isHome else 'h-12 md:h-16' }} w-auto object-contain" id="logo-img">
            {% if isHome %}
            <!-- Fallback logo (hidden by default) -->
            <div id="logo-fallback" class="hidden flex-col leading-none select-none" role="img" aria-label="{{ site.name }}">
                <div class="flex items-center text-3xl font-extrabold tracking-tighter">
                    <span class="text-slate-800">CB</span>
                    <span class="text-lime-500">Účto</span>
                </div>
                <span class="text-xs text-slate-500 tracking-widest uppercase font-medium ml-0.5">s.r.o.</span>
            </div>
            {% endif %}
        </a>

        <!-- Desktop Menu -->
        <div class="hidden md:flex items-center space-x-8 font-medium text-slate-200 bg-slate-900/95 px-6 py-2.5 rounded-full backdrop-blur-sm border border-slate-700 shadow-xl hover:bg-slate-800 transition-all">
            <a href="{{ navPrefix }}#sluzby" class="hover:text-lime-400 transition-colors">Služby</a>
            <a href="{{ navPrefix }}#cenik" class="hover:text-lime-400 transition-colors">Ceník</a>
            <a href="{{ navPrefix }}#blog" class="hover:text-lime-400 transition-colors{{ ' text-lime-400' if not isHome }}"{% if not isHome %} aria-current="page"{% endif %}>Blog</a>
            <a href="{{ navPrefix }}#kontakt" class="hover:text-lime-400 transition-colors">Kontakt</a>
        </div>

        <!-- Contact & Mobile Toggle -->
        <div class="flex items-center gap-4">
            <a href="tel:{{ site.phone }}" class="hidden lg:flex items-center gap-2 font-bold text-slate-700 hover:text-lime-600 transition-colors">
                {{ phone() }}
                {{ site.phoneFormatted }}
            </a>
            {% if isHome %}
            <a href="#kontakt-formular" class="hidden sm:block px-5 py-2.5 bg-lime-500 text-white rounded-full hover:bg-lime-600 transition-all shadow-lg hover:shadow-lime-500/40 font-bold text-sm uppercase tracking-wide">
                Napsat nám
            </a>
            <!-- Mobile Menu Button -->
            <button id="menu-toggle" class="md:hidden text-slate-800 p-2" aria-label="Otevřít menu" aria-expanded="false" aria-controls="mobile-menu">
                {{ hamburger("w-7 h-7") }}
                {{ close("w-7 h-7 hidden") }}
            </button>
            {% endif %}
        </div>
    </div>

    {% if isHome %}
    <!-- Mobile Menu Dropdown -->
    <div id="mobile-menu" role="navigation" aria-label="Mobilní menu" class="hidden absolute top-full left-0 w-full bg-white/95 backdrop-blur-xl shadow-xl border-t border-slate-100 flex-col p-6 space-y-4 animate-slide-in md:hidden">
        <a href="#sluzby" class="mobile-link text-lg font-medium text-slate-700">Služby</a>
        <a href="#cenik" class="mobile-link text-lg font-medium text-slate-700">Ceník</a>
        <a href="#blog" class="mobile-link text-lg font-medium text-slate-700">Blog</a>
        <a href="#kontakt" class="mobile-link text-lg font-medium text-lime-600 font-bold">Kontaktujte nás</a>
    </div>
    {% endif %}
</nav>
